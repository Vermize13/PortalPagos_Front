<div class="container-fluid p-4">
  <p-card>
    <div class="flex justify-content-between align-items-center mb-4">
      <h2 class="m-0">Auditoría del Sistema</h2>
      <p-button label="Exportar" icon="pi pi-download" (onClick)="onExport()"></p-button>
    </div>

    <p-table 
      [value]="auditLogs" 
      [loading]="loading"
      [paginator]="true" 
      [rows]="20"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} registros"
      [rowsPerPageOptions]="[20, 50, 100]"
      styleClass="p-datatable-striped">
      
      <ng-template pTemplate="header">
        <tr>
          <th>Fecha/Hora</th>
          <th>Usuario</th>
          <th>Acción</th>
          <th>Tipo Entidad</th>
          <th>ID Entidad</th>
          <th>Descripción</th>
        </tr>
      </ng-template>
      
      <ng-template pTemplate="body" let-log>
        <tr>
          <td>{{ log.createdAt | date:'short' }}</td>
          <td>
            <div class="font-semibold">{{ log.userName }}</div>
            <div class="text-sm text-gray-500">{{ log.userEmail }}</div>
          </td>
          <td>
            <p-tag [value]="log.action" [severity]="getActionSeverity(log.action)"></p-tag>
          </td>
          <td>{{ log.entityType }}</td>
          <td>{{ log.entityId || '-' }}</td>
          <td>{{ log.description }}</td>
        </tr>
      </ng-template>
      
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6" class="text-center">No se encontraron registros de auditoría.</td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>
